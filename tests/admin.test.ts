import * as AdminSDK from "../admin-sdk";
import * as dotenv from "dotenv";

dotenv.config();

const basePath = process.env.BASE_PATH;

const credentials: AdminSDK.AdminApiAuthentication = {
  applicationId: process.env.ADMIN_APP_ID,
  sharedSecret: process.env.ADMIN_SECRET
};

describe("Administration API", () => {
  let sdk;

  beforeAll(() => {
    sdk = new AdminSDK.API({
      basePath
    });
  })

  it("should successfully call IntelliTrust", async () => {

    const authResponse = await sdk.authenticateAdminApiUsingPOST(credentials);

    expect(authResponse.status).toBe(200);

    const { authToken } = authResponse.data;

    sdk.setApiKey(authToken);

    const listResponse = await sdk.listAuthApiApplicationsUsingGET();

    expect(listResponse.status).toBe(200);
  });


  describe('IdProofing', () => {
    beforeEach( async () => {
      const authResponse = await sdk.authenticateAdminApiUsingPOST(credentials);
    
      const { authToken } = authResponse.data;
  
      sdk.setApiKey(authToken);
    })

  it("should successfully initiate an IDProofing Request", async () => {
  
      const idProofingResponse = await sdk.idProofingInitUsingPOST();
  
      expect(idProofingResponse.status).toBe(200);
  
    });

  it('should successfully upload an image', async () => {
      const image = "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"

      const idProofingResponse = await sdk.idProofingInitUsingPOST();
        
      const imageResponse = await sdk.idProofingImageUsingPUT(idProofingResponse.data.requestId, 0, Buffer.from(image, 'base64'));        
        
      expect(imageResponse.status).toBe(200);
    });
  })
});
